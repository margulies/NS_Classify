def region_heatmap(self, basename=None, zscore_regions=False, zscore_features=False, zthresh=None):

    fi = self.feature_importances.mean(axis=0).T

    z0 = ""
    z1 = ""
    t = ""

    if zscore_regions:
        fi = np.apply_along_axis(stats.zscore, 0, fi)
        z0 = "z0_"
    if zscore_features:
        fi = np.apply_along_axis(stats.zscore, 1, fi)
        z1 = "z1_"

    if zthresh is not None:
        fi = np.ma.masked_array(fi)
        fi.mask = fi < zthresh
        t = "zt" + str(zthresh) + "_"

    heat_map(fi, range(0,self.mask_num), self.feature_names, basename + "_imps_hm_" +  z0 + z1 + t + "overall.png")

    for i in range(0, self.mask_num):

        fi = self.feature_importances[i].T

        if zscore_regions:
            fi = np.ma.masked_invalid(stats.zscore(fi, axis=0))
        if zscore_features:
            fi = stats.zscore(fi, axis=1)

        if zthresh is not None:
            fi.mask = fi < zthresh

        if basename is None:
            file_name = None
        else:
            file_name = basename + "_imps_hm_" + z0 + z1 + t + str(i) + ".png"

        heat_map(fi, range(0,self.mask_num), self.feature_names, file_name)